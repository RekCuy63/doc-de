<?xml version="1.0" encoding="utf-8"?>
<!-- EN-Revision: 0b005cfe4e7075d8f7c7472545eaee2b7f38526e Maintainer: samesch Status: wip -->
<sect1 xml:id="migration81.new-features" xmlns:xlink="http://www.w3.org/1999/xlink">
 <title>Neue Features</title>

 <sect2 xml:id="migration81.new-features.core">
  <title>PHP-Kern</title>

  <sect3 xml:id="migration81.new-features.core.octal-literal-prefix">
   <title>Präfix für oktale Integer-Literale</title>

   <para>
    Bei oktalen Integern ist es nun möglich, explizit <literal>0o</literal>
    oder <literal>0O</literal> als Präfix für numerische Literale anzugeben.
    Dies entspricht der Notation für binäre und hexadezimale Integer-Literale.     Octal integers can now use an explicit
    <informalexample>
     <programlisting role="php">
<![CDATA[
<?php
014;  // Oktales Literal ohne Präfix
0o14; // Oktales Literal mit Präfix
?>
]]>
     </programlisting>
    </informalexample>
   </para>
   <!-- RFC: https://wiki.php.net/rfc/explicit_octal_notation -->
  </sect3>

  <sect3 xml:id="migration81.new-features.core.unpacking-string-keys">
   <title>Entpacken von Arrays mit String-Schlüsseln</title>

   <para>
    Die Unterstützung für das
    <link linkend="language.types.array.unpacking">Entpacken von Arrays mit String-Schlüsseln</link>
    wurde hinzugefügt.
    <informalexample>
     <programlisting role="php">
<![CDATA[
<?php
$arr1 = [1, 'a'];
$arr2 = [...$arr1, 'c' => 'd']; //[1, 'a', 'c' => 'd']
?>
]]>
     </programlisting>
    </informalexample>
   </para>
   <!-- RFC: https://wiki.php.net/rfc/array_unpacking_string_keys -->
  </sect3>

  <sect3 xml:id="migration81.new-features.core.named-arg-after-unpack">
   <title>Benannter Parameter nach dem Entpacken von Parametern</title>

   <para>
    Es ist nun möglich, benannte Parameter nach einem entpackten Parameter
    anzugeben.
    <!-- TODO Add an example -->
    z. B.
    foo(...$args, named: $arg).
   </para>
  </sect3>

  <sect3 xml:id="migration81.new-features.core.upload-full-path-key">
   <title>Vollständiger Pfad beim Hochladen von Dateien</title>

   <para>
    Datei-Uploads bieten nun einen zusätzlichen
    <literal>full_path</literal>-Schlüssel, der den vollständigen Pfad (und
    nicht nur den Basisnamen) der hochgeladenen Datei enthält. Dies ist für
    die Verwendung in Verbindung mit dem HTML-Attribut "webkitdirectory"
    gedacht.
   </para>
   <!-- RFC: https://wiki.php.net/rfc/array_unpacking_string_keys -->
  </sect3>

  <sect3 xml:id="migration81.new-features.core.enums">
   <title>Aufzählungen</title>

   <para>
    Die Unterstützung für
    <link linkend="language.enumerations">Aufzählungen</link> wurde
    hinzugefügt.
    <!-- RFC: https://wiki.php.net/rfc/enumerations -->
   </para>
  </sect3>

  <sect3 xml:id="migration81.new-features.core.fibers">
   <title>Fibers</title>

   <para>
    Die Unterstützung für
    <link linkend="language.fibers">Fibers</link> wurde hinzugefügt.
    <!-- RFC: https://wiki.php.net/rfc/fibers -->
   </para>
  </sect3>

  <sect3 xml:id="migration81.new-features.core.callable-syntax">
   <title>Callback-Funktionen als Objekte erster Klasse</title>

   <para>
    Closures für Callback-Funktionen können nun mit
    <link linkend="functions.first_class_callable_syntax">der Syntax <code>myFunc(...)</code></link>
    erstellt werden, die identisch ist zu
    <code>Closure::fromCallable('myFunc')</code>. 
    <!-- RFC: https://wiki.php.net/rfc/first_class_callable_syntax -->
   </para>
   <note>
    <simpara>
     Das <code>...</code> ist keine Auslassung, sondern Teil der Syntax.
    </simpara>
   </note>
  </sect3>

  <sect3 xml:id="migration81.new-features.core.intersection-types">
   <title>Überschneidungstypen</title>

   <para>
    Die Unterstützung für
    <!--<link linkend="language.types.declarations.intersection">-->Überschneidungstypen<!--</link>-->
    wurde hinzugefügt.
    <!-- RFC: https://wiki.php.net/rfc/pure-intersection-types -->
   </para>
   <caution>
    <simpara>
     Überschneidungstypen können nicht zusammen mit
     <link linkend="language.types.declarations.union" >zusammengefassten Typen (Union-Typen)</link>
     verwendet werden.
    </simpara>
   </caution>
  </sect3>

  <sect3 xml:id="migration81.new-features.core.never-type">
   <title>Never-Typ</title>

   <para>
    Der neue Rückgabetyp &never; wurde hinzugefügt. Dieser zeigt an, dass eine
    Funktion entweder <function>exit</function> aufruft, eine Exception
    auslöst, oder nicht beendet wird.
    <!-- RFC: https://wiki.php.net/rfc/noreturn_type -->
   </para>
  </sect3>

  <sect3 xml:id="migration81.new-features.core.new-in-initializer">
   <title>&new; in Initialisierungen</title>

   <para>
    Es ist nun möglich, <code>new ClassName()</code>-Ausdrücke als
    Standardwert für die Initialisierung von Parametern, statischen Variablen
    und globalen Konstanten und als Eigenschafts-Parameter zu verwenden.
    Objekte können nun ebenfalls an <function>define</function> übergeben
    werden.
    <!-- TODO Add an example -->
   </para>
   <!-- RFC: https://wiki.php.net/rfc/new_in_initializers -->
  </sect3>

  <sect3 xml:id="migration81.new-features.core.readonly">
   <title>Eigenschaften, die nur gelesen werden können</title>

   <para>
    Die Unterstützung für
    <link linkend="language.oop5.properties.readonly-properties">readonly</link>
    wurde hinzugefügt.
    <!-- RFC: https://wiki.php.net/rfc/readonly_properties_v2 -->
   </para>
  </sect3>

  <sect3 xml:id="migration81.new-features.core.final-constants">
   <title>Finale Klassenkonstanten</title>

   <para>
    Die Unterstützung für
    <link linkend="language.oop5.final.example.php81">den Modifikator <modifier>final</modifier> für Klassenkonstanten</link>
    wurde hinzugefügt. Außerdem werden Schnittstellenkonstanten standardmäßig
    überschreibbar.
    <!-- RFC: https://wiki.php.net/rfc/final_class_const -->
   </para>
  </sect3>

 </sect2>

 <sect2 xml:id="migration81.new-features.curl">
  <title>CURL</title>
  
  <para>
   Die Option <constant>CURLOPT_DOH_URL</constant> wurde hinzugefügt.
  </para>

  <para>
   Zusätzliche Optionen für Blob-Zertifikate, falls libcurl &gt;= 7.71.0:
  </para>
  <itemizedlist>
   <listitem>
    <simpara><constant>CURLOPT_ISSUERCERT_BLOB</constant></simpara>
   </listitem>
   <listitem>
    <simpara><constant>CURLOPT_PROXY_ISSUERCERT</constant></simpara>
   </listitem>
   <listitem>
    <simpara><constant>CURLOPT_PROXY_ISSUERCERT_BLOB</constant></simpara>
   </listitem>
   <listitem>
    <simpara><constant>CURLOPT_PROXY_SSLCERT_BLOB</constant></simpara>
   </listitem>
   <listitem>
    <simpara><constant>CURLOPT_PROXY_SSLKEY_BLOB</constant></simpara>
   </listitem>
   <listitem>
    <simpara><constant>CURLOPT_SSLCERT_BLOB</constant></simpara>
   </listitem>
   <listitem>
    <simpara><constant>CURLOPT_SSLKEY_BLOB</constant></simpara>
   </listitem>
  </itemizedlist>

  <para>
   Die Klasse <classname>CURLStringFile</classname> wurde hinzugefügt. Sie
   kann dazu verwendet werden, statt einer Datei eine Datei aus einem &string;
   zu senden:
   <informalexample>
    <programlisting role="php">
<![CDATA[
<?php
$datei = new CURLStringFile($daten, 'dateiname.txt', 'text/plain');
curl_setopt($curl, CURLOPT_POSTFIELDS, ['datei' => $datei]);
?>
]]>
    </programlisting>
   </informalexample>
  </para>
 </sect2>

 <sect2 xml:id="migration81.new-features.fpm">
  <title>FPM</title>

  <para>
   Added openmetrics status format. It can be used by Prometheus to fetch FPM
   metrics.
  </para>
  <para>
   Added new pool option for the dynamic process manager called
   <literal>pm.max_spawn_rate</literal>. It allows to start a number of children
   at a faster rate when dynamic pm is selected.
   The default value is <literal>32</literal> which was the previous
   hard coded value.
  </para>
 </sect2>

 <sect2 xml:id="migration81.new-features.gd">
  <title>GD</title>

  <para>
   Avif support is now available through
   <function>imagecreatefromavif</function> and
   <function>imageavif</function>,
   if libgd has been built with Avif support.
  </para>
 </sect2>

 <sect2 xml:id="migration81.new-features.hash">
  <title>Hash</title>

  <para>
   The following functions <function>hash</function>,
   <function>hash_file</function>, and <function>hash_init</function>
   now support an additional optional <parameter>options</parameter>
   argument, which can be used to pass algorithm specific data.
  </para>

  <sect3 xml:id="migration81.new-features.hash.murmurhash3">
   <title>MurmurHash3</title>

   <para>
    Added support for <literal>MurmurHash3</literal> with streaming
    support. The following variants are implemented:
   </para>
   <itemizedlist>
    <listitem>
     <simpara>murmur3a, 32-bit hash</simpara>
    </listitem>
    <listitem>
     <simpara>murmur3c, 128-bit hash for x86</simpara>
    </listitem>
    <listitem>
     <simpara>murmur3f, 128-bit hash for x64</simpara>
    </listitem>
   </itemizedlist>

   <para>
    The initial hash state can be passed through the <literal>seed</literal>
    key in the <parameter>options</parameter> array, for example:

    <informalexample>
     <programlisting role="php">
      <![CDATA[
<?php
$h = hash("murmur3f", $data, options: ["seed" => 42]);
echo $h, "\n";
?>
]]>
     </programlisting>
    </informalexample>

    A valid seed value is within the range from <literal>0</literal>
    to the platform defined <constant>UINT_MAX</constant>, usually
    <literal>4294967295</literal>.
   </para>
  </sect3>

  <sect3 xml:id="migration81.new-features.hash.xxhash">
   <title>xxHash</title>

   <para>
    Added support for <literal>xxHash</literal>.
    The following variants are implemented:
   </para>
   <itemizedlist>
    <listitem>
     <simpara>xxh32, 32-bit hash</simpara>
    </listitem>
    <listitem>
     <simpara>xxh64, 64-bit hash</simpara>
    </listitem>
    <listitem>
     <simpara>xxh3, 64-bit hash</simpara>
    </listitem>
    <listitem>
     <simpara>xxh128, 128-bit hash</simpara>
    </listitem>
   </itemizedlist>

   <para>
    The initial hash state can be passed through the <literal>seed</literal>
    key in the <parameter>options</parameter> array, for example:

    <informalexample>
     <programlisting role="php">
      <![CDATA[
<?php
$h = hash("xxh3", $data, options: ["seed" => 42]);
echo $h, "\n";
?>
]]>
     </programlisting>
    </informalexample>

    Secret usage is supported through passing the <literal>secret</literal>
    key in the <parameter>options</parameter> array, too:

    <informalexample>
     <programlisting role="php">
      <![CDATA[
<?php
$h = hash("xxh3", $data, options: ["secret" => "at least 136 bytes long secret here"]);
echo $h, "\n";
?>
]]>
     </programlisting>
    </informalexample>

    The quality of the custom secret is crucial for the quality of the resulting hash.
    It is highly recommended for the secret to use the best possible entropy.
   </para>
  </sect3>
 </sect2>

 <sect2 xml:id="migration81.new-features.mysqli">
  <title>MySQLi</title>

  <sect3 xml:id="migration81.new-features.mysqli.local_infile_directory">
   <title>New INI directive <literal>mysqli.local_infile_directory</literal></title>

   <para>
    The <link linkend="ini.mysqli.local-infile-directory">mysqli.local_infile_directory</link>
    INI directive has been added, which can be used to specify a directory from
    which files are allowed to be loaded. It is only meaningful if
    <link linkend="ini.mysqli.allow-local-infile">mysqli.allow_local_infile</link>
    is not enabled, as all directories are allowed in that case.
   </para>
  </sect3>

  <sect3 xml:id="migration81.new-features.mysqli.bind-in-execute">
   <title>Binding parameters in execute</title>

   <para>
    It is now possible to bind parameters by passing them as an array to 
    <methodname>mysqli_stmt::execute</methodname>. All values will be bound as
    strings. Only list arrays are allowed. This new feature is not available
    when MySQLi is compiled with libmysqlclient.
    <!-- RFC: https://wiki.php.net/rfc/mysqli_bind_in_execute -->
    <informalexample>
     <programlisting role="php">
<![CDATA[
<?php
$stmt = $mysqli->prepare('INSERT INTO users(id, name) VALUES(?,?)');
$stmt->execute([1, $username]);
?>
]]>
     </programlisting>
    </informalexample>
   </para>
  </sect3>

  <sect3 xml:id="migration81.new-features.mysqli.mysqli_fetch_column">
   <title>New method <methodname>mysqli_result::fetch_column</methodname></title>

   <para>
    <methodname>mysqli_result::fetch_column</methodname>
    has been added to allow fetching a single scalar value from the result set.
    The new method accepts an optional 0-based <parameter>column</parameter>
    parameter of type &integer; specifying which column to fetch from.
    <!-- RFC: https://wiki.php.net/rfc/mysqli_fetch_column -->
    <informalexample>
     <programlisting role="php">
<![CDATA[
<?php
$result = $mysqli->query('SELECT username FROM users WHERE id = 123');
echo $result->fetch_column();
?>
]]>
     </programlisting>
    </informalexample>
   </para>
  </sect3>

 </sect2>

 <sect2 xml:id="migration81.new-features.pdo_mysql">
  <title>PDO</title>

  <para>
   The <constant>PDO::MYSQL_ATTR_LOCAL_INFILE_DIRECTORY</constant> attribute
   has been added, which can be used to specify a directory from which files
   are allowed to be loaded.
   It is only meaningful if <constant>PDO::MYSQL_ATTR_LOCAL_INFILE</constant>
   is not enabled, as all directories are allowed in that case.
  </para>
 </sect2>

 <sect2 xml:id="migration81.new-features.pdo_sqlite">
  <title>PDO_SQLite</title>

  <para>
   SQLite's <literal>"file:"</literal> DSN syntax is now supported,
   which allows specifying additional flags.
   This feature is not available if open_basedir is set.
   <informalexample>
    <programlisting role="php">
<![CDATA[
<?php
new PDO('sqlite:file:path/to/sqlite.db?mode=ro')
?>
]]>
    </programlisting>
   </informalexample>
  </para>
 </sect2>

 <sect2 xml:id="migration81.new-features.posix">
  <title>POSIX</title>

  <para>
   Added <constant>POSIX_RLIMIT_KQUEUES</constant> and <constant>POSIX_RLIMIT_NPTS</constant>.
   These rlimits are only available on FreeBSD.
  </para>
 </sect2>

 <sect2 xml:id="migration81.new-features.standard">
  <title>Standard</title>

  <para>
   <function>fputcsv</function> now accepts a new
   <parameter>eol</parameter> argument which allow to define a custom
   End of Line sequence, the default remains the same and is <literal>"\n"</literal>.
  </para>
 </sect2>

 <sect2 xml:id="migration81.new-features.spl">
  <title>SPL</title>

  <para>
   <methodname>SplFileObject::fputcsv</methodname> now accepts a new
   <parameter>eol</parameter> argument which allow to define a custom
   End of Line sequence, the default remains the same and is <literal>"\n"</literal>.
  </para>
 </sect2>

</sect1>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"~/.phpdoc/manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
